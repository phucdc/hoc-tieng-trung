{% extends "base.html" %} {% block title %}Home{% endblock %} {% block body %}
{% for tab in tabs %}
<button type="button" class="btn btn-outline-dark">{{ tab.name }}</button>
{% endfor %}
<br />
<br />
<br />
<table class="table">
  <thead>
    <tr>
      <th scope="col">
        
      </th>
      <th scope="col">#</th>
      <th scope="col">Hán tự</th>
      <th scope="col">Nghĩa</th>
    </tr>
  </thead>
  <tbody id="word-table-body">
    {% for word in words %}
    <tr>
      <th>
        <div class="form-check">
          <input
            class="form-check-input check-item"
            type="checkbox"
            value="{{ word.id }}"
          />
        </div>
      </th>
      <td>{{ loop.index }}</td>
      <td>{{ word.word }}</td>
      <td>{{ word.meaning }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<script>
  const checkAll = document.querySelector(".check-all");
  const checkItems = document.querySelectorAll(".check-item");
  const learnBtn = document.getElementById("learn-btn");
  const addWordBtn = document.getElementById("add-word");
  const wordInput = document.getElementById("word-input");
  const meaningInput = document.getElementById("meaning-input");
  const tableBody = document.getElementById("word-table-body");

  checkAll.addEventListener("change", function () {
    checkItems.forEach(function (checkbox) {
      checkbox.checked = checkAll.checked;
    });
  });

  learnBtn.addEventListener("click", function () {
    const word_ids = Array.from(checkItems)
      .filter((checkbox) => checkbox.checked)
      .map((checkbox) => checkbox.value);

    // Send the selected values to the server
    // You can use fetch, axios, or any other method to send the data
    // Example with fetch:
    fetch("/learn", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ word_ids }),
    })
    .then((response) => response.text())
    .then((html) => {
      // Update the entire document with the rendered HTML
      document.documentElement.innerHTML = html;
    })
    .catch((error) => {
      // Handle any errors
      console.error(error);
    });
  });

  function validateInputs() {
    const word = wordInput.value.trim();
    const meaning = meaningInput.value.trim();

    if (word && meaning) {
      addWordBtn.disabled = false;
    } else {
      addWordBtn.disabled = true;
    }
  }

  wordInput.addEventListener("input", validateInputs);
  meaningInput.addEventListener("input", validateInputs);

  addWordBtn.addEventListener("click", function () {
    const word = wordInput.value.trim();
    const meaning = meaningInput.value.trim();

    fetch("/word/add", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ word, meaning }),
    })
      .then((response) => response.text())
      .then((html) => {
        // Update the entire document with the rendered HTML
        document.documentElement.innerHTML = html;
      })
      .catch((error) => {
        // Handle any errors
        console.error(error);
      });
  });
</script>
{% endblock %}
